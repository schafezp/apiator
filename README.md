
# README #

This README documents how to set up and use this project.

### What is this repository for? ###

* Quick summary

Apiator provides a client/server infrastructure for dynamically generating api endpoints for document based models with high performance and providing data replication across any number of nodes.

* Version

This is an alpha version of apiator.

### How do I get set up? ###

* Summary of set up

This stack was developed with CentOs 7. Tested version numbers will be added before we mark the git repo as [passing](https://github.com/dwyl/repo-badges).

Deploying this entire stack involves configuring Couchbase, Redis, and Solr.

Both the server and the cli are written in Go, so you must set up a Go environment.

* Configuration

[Here is a link to get Go setup](https://golang.org/doc/install)

* Dependencies

* Couchbase configuration

Here is a link for installing [Couchbase](https://developer.couchbase.com/documentation/server/current/install/install-linux.html) on any linux

Here is a link for installing [Couchbase](https://developer.couchbase.com/documentation/server/current/install/install-linux.html) specifically on CentOS 7.

Once you've started Couchbase, you should be able to go to localhost:8091 in the web browser to configure it. Create an admin username and password and then put those values as well as the address to the host in the apiator-server/apiator-server.go

In the future there will be a seperate config file that holds all server address/passwords.

Create users and endpoints data buckets through the ui. You can make the users bucket relatively small and the endpoints bucket larger but leaving enough space for new buckets to be dynamically generated at runtime.

In the future we will offer the choice to dynamically generate users/endpoints buckets with sane defaults.

* Redis configuration
Here is a link for installing [Redis](https://www.linode.com/docs/databases/redis/deploy-redis-on-centos-7) on CentOs 7

Make sure to set a password in /etc/redis.conf

Once you've set that password, make sure to change the password in the apiator-server/apiator-server.go const field.
In the future there will be seperate config file, and we will provide a default redis.conf to use.


* Solr configuration
Here is a link for configuring [Solr](http://idroot.net/tutorials/how-to-install-apache-solr-on-centos-7/) on CentOs 7


* How to run tests

No testsuite currently exists. This project is still actively in development and we will create tests at the end once the features are locekd in

* Deployment instructions

Once Go is setup and you have an $GOBIN environment, run

```bash
    go install apiator-server/apiator-server.go
    go install apiator-cli/apiator-cli.go
```
This should download any needed dependencies and create an executible named apiator-server.

To use apiator, first start the apiator-server as a daemon. By default it runs on port 8000.
In the future the port will be specified in the config file or sys args and default to 8000 when no value is given.
Additionally a systemd script for apiator-server will be available




### How do I use this? ###

In order to connect to the apiator-server, a user needs a username and password. Currently the first user is generated by going to the Couchbase webui and inserting a document consiting of

```json
    {"username":"user","password":"pass"}
```

In the future the server will generate a default admin user based on the initial config file based to the server.

Next start the apiator-cli by running the executible with no arguments.

To connect to the apiator-server run the following. 

```bash
    apiator-cli connect -u user -p password localhost:8000
```
If the apiator-server is running on a different address change localhost:8000 to be that address and change user and password to be the appropriate username and password.

If the cli can connect to the server it will indicate that a "200" response was returned. The apiator-cli in the response from the server recieves a json web token that it stores and will use to try to authenticate with each future request. The token has an expiration time encoded into it, and additionally the server can choose to unauthenticate a logged in user by removing the token from it's internal datastore before the tokens natural expiration.


Once connected, a user can create a custom endpoint that they will be able to insert data into.

The application is self documenting so you can do pass apiator-cli "--help" and it will show all command options available.

In the future the entire functional documentation will be available on this README.

### Contribution guidelines ###

* Writing tests

Please wait until development has stabalized before writing tests.

<!-- * Code review -->
* Push requests

All push requests will be vetted by the apiator team.

* Other guidelines



### Who do I talk to? ###

* Repo owner or admin

Contact the owner of this repo.

<!-- * Other community or team contact -->

